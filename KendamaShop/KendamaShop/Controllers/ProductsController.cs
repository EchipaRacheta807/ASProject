using KendamaShop.Models;
using Microsoft.AspNet.Identity;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace KendamaShop.Controllers
{
    public class ProductsController : Controller
    {
        public ApplicationDbContext db = new ApplicationDbContext();

        private int _perPage = 10;
        private static string sortingCriterium = "date_asc";
        private static string default_img = "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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/9k=";

        // GET: Products
        public ActionResult Index()
        {
            var products = db.Products.Include("Category").Include("User").Where(prod => prod.Accepted).OrderBy(prod => prod.Date);
            var search = "";

            if (Request.Params.Get("search") != null)
            {
                search = Request.Params.Get("search").Trim();

                // Search in product title and description
                List<int> productIds = db.Products.Where(
                    prod => prod.Title.Contains(search) || prod.Description.Contains(search)
                    ).Select(prod => prod.ProductId).ToList();

                // Search in reviews
                List<int> reviewIds = db.Reviews.Where(
                    rev => rev.Content.Contains(search)
                    ).Select(rev => rev.ProductId).ToList();

                List<int> mergedIds = productIds.Union(reviewIds).ToList();

                products = db.Products.Include("Category").Include("User").Where(prod => mergedIds.Contains(prod.ProductId)).OrderBy(prod => prod.Date);
            }

            // sort the list of products
            if (sortingCriterium == "price_asc")
            {
                products = products.OrderBy(prod => prod.Price);
            }
            else if (sortingCriterium == "price_desc")
            {
                products = products.OrderByDescending(prod => prod.Price);
            }
            else if (sortingCriterium == "rating_asc")
            {
                products = products.OrderBy(prod => prod.Rating);
            }
            else if (sortingCriterium == "rating_desc")
            {
                products = products.OrderByDescending(prod => prod.Rating);
            }
            else if (sortingCriterium == "date_asc")
            {
                products = products.OrderBy(prod => prod.Date);
            }
            else if (sortingCriterium == "date_desc")
            {
                products = products.OrderByDescending(prod => prod.Date);
            }

            var totalItems = products.Count();
            var currentPage = Convert.ToInt32(Request.Params.Get("page"));
            var offset = 0;

            if (!currentPage.Equals(0))
            {
                offset = (currentPage - 1) * this._perPage;
            }

            var paginatedProducts = products.Skip(offset).Take(this._perPage);

            if (TempData.ContainsKey("message"))
            {
                ViewBag.message = TempData["message"].ToString();
            }

            ViewBag.total = totalItems;
            ViewBag.lastPage = Math.Ceiling((float)totalItems / (float)this._perPage);
            ViewBag.Products = paginatedProducts;
            ViewBag.SearchString = search;

            return View();
        }

        public ActionResult SetSortingCriterium(string sortParam)
        {
            sortingCriterium = sortParam;
            return RedirectToAction("Index");
        }

        [Authorize(Roles = "Admin")]
        public ActionResult Pending()
        {
            var products = db.Products.Include("Category").Include("User").Where(prod => prod.Accepted == false);
            if (TempData.ContainsKey("message")){
                ViewBag.Message = TempData["message"];
            }

            ViewBag.Products = products;

            return View();
        }

        [Authorize(Roles = "Admin")]
        public ActionResult Accept(int id)
        {
            var product = db.Products.Find(id);
            if (product.Accepted)
            {
                TempData["message"] = "Tried to perform invalid Accepting command";
                return RedirectToAction("Pending");
            }
            if (TryUpdateModel(product))
            {
                product.Accepted = true;
                db.SaveChanges();
                TempData["message"] = "The product was accepted successfully";
                return RedirectToAction("Pending");
            }

            TempData["message"] = "Could not accept product, try again later";
            return RedirectToAction("Pending");
        }

        [Authorize(Roles = "Admin")]
        public ActionResult Decline(int id)
        {
            Product product = db.Products.Find(id);
            db.Products.Remove(product);
            db.SaveChanges();
            TempData["message"] = "The product was declined!";
            return RedirectToAction("Pending");
        }

        // GET
        public ActionResult Show(int id)
        {
            var product = db.Products.Find(id);
            if (TempData.ContainsKey("message"))
            {
                ViewBag.Message = TempData["message"];
            }
            SetAccessRights();
            return View(product);
        }

        [Authorize(Roles = "User,Partner,Admin")]
        [HttpPost]
        public ActionResult Show(Review review)
        {
            review.Date = DateTime.Now;
            review.UserId = User.Identity.GetUserId();
            try
            {
                if (ModelState.IsValid)
                {
                    db.Reviews.Add(review);
                    db.SaveChanges();
                    TempData["message"] = "The review was added!";
                    return Redirect("/Products/Show/" + review.ProductId.ToString());
                }
                else
                {
                    Product prod = db.Products.Find(review.ProductId);
                    SetAccessRights();
                    return View(prod);
                }

            }
            catch (Exception e)
            {
                Product prod = db.Products.Find(review.ProductId);
                SetAccessRights();
                return View(prod);
            }
        }

        [Authorize(Roles = "Partner,Admin")]
        public ActionResult New()
        {
            Product product = new Product();
            product.Categ = GetAllCategories();
            product.PartnerId = User.Identity.GetUserId();
            return View(product);
        }

        [NonAction]
        private bool IsImage(HttpPostedFileBase file)
        {
            if (file == null)
            {
                return true;
            }

            if (file.ContentType.Contains("image"))
            {
                return true;
            }

            string[] formats = new string[] { ".jpg", ".png", ".gif", ".jpeg", ".img" };

            return formats.Any(item => file.FileName.EndsWith(item, StringComparison.OrdinalIgnoreCase));
        }

        [HttpPost]
        [Authorize(Roles = "Partner,Admin")]
        public ActionResult New(Product product, HttpPostedFileBase ImageFileBase)
        {
            product.Date = DateTime.Now;
            product.PartnerId = User.Identity.GetUserId();
            product.Accepted = false;

            byte[] imgByte;

            if (IsImage(ImageFileBase))
            {
                if (ImageFileBase != null)
                {
                    imgByte = new byte[ImageFileBase.ContentLength];
                    ImageFileBase.InputStream.Read(imgByte, 0, ImageFileBase.ContentLength);
                    product.ImageFile = Convert.ToBase64String(imgByte);
                }
                else
                {
                    product.ImageFile = default_img;
                }
            }
            else
            {
                ModelState.AddModelError("", "This file should be an image");
            }

            try
            {
                if (ModelState.IsValid)
                {
                    if (User.IsInRole("Admin"))
                    {
                        product.Accepted = true;
                        TempData["message"] = "The product was added to the database!";
                    }
                    else
                    {
                        TempData["message"] = "The request to add the product has been sent!";
                    }
                    db.Products.Add(product);
                    db.SaveChanges();
                    return RedirectToAction("Index");
                }
                else
                {
                    product.Categ = GetAllCategories();
                    return View(product);
                }                
            }
            catch (Exception e)
            {
                product.Categ = GetAllCategories();
                return View(product);
            }
        }

        [Authorize(Roles = "Partner,Admin")]
        public ActionResult Edit(int id)
        {
            Product product = db.Products.Find(id);
            product.Categ = GetAllCategories();

            if (product.PartnerId == User.Identity.GetUserId() || User.IsInRole("Admin"))
            {
                return View(product);
            }

            else
            {
                TempData["message"] = "You don't have sufficient rights to modify the product!";
                return RedirectToAction("Index");
            }
        }

        [HttpPut]
        [Authorize(Roles = "Partner,Admin")]
        public ActionResult Edit(int id, Product requestProd)
        {
            requestProd.Categ = GetAllCategories();

            try
            {
                if (ModelState.IsValid)
                {
                    Product product = db.Products.Find(id);

                    if (product.PartnerId == User.Identity.GetUserId() || User.IsInRole("Admin"))
                    {
                        if (TryUpdateModel(product))
                        {
                            // Make sure the edit form contains all model properties
                            product.Title = requestProd.Title;
                            product.Description = requestProd.Description;
                            product.Price = requestProd.Price;
                            product.Rating = requestProd.Rating;
                            product.Categ = requestProd.Categ;
                            db.SaveChanges();
                            TempData["message"] = "The product info was modified!";
                        }
                        return Redirect("/Products/Show/" + product.ProductId);
                    }
                    else
                    {
                        TempData["message"] = "Insufficient rights to modify the product!";
                        return RedirectToAction("Index");   
                    }
                    
                }
                else
                {
                    return View(requestProd);
                }
            }
            catch (Exception e)
            {
                return View(requestProd);
            }
        }

        [HttpDelete]
        [Authorize(Roles = "Partner, Admin")]
        public ActionResult Delete(int id)
        {
            Product product = db.Products.Find(id);
            if (product.PartnerId == User.Identity.GetUserId() || User.IsInRole("Admin"))
            {
                db.Products.Remove(product);
                db.SaveChanges();
                TempData["message"] = "The product was deleted!";
                return RedirectToAction("Index");
            }
            else
            {
                TempData["message"] = "Insufficient rights to delete the product!";
                return RedirectToAction("Index");
            }
        }

        [NonAction]
        public IEnumerable<SelectListItem> GetAllCategories()
        {
            // generam o lista goala
            var selectList = new List<SelectListItem>();

            // extragem toate categoriile din baza de date
            var categories = from cat in db.Categories
                             select cat;

            // iteram prin categorii
            foreach (var category in categories)
            {
                // adaugam in lista elementele necesare pentru dropdown
                selectList.Add(new SelectListItem
                {
                    Value = category.CategoryId.ToString(),
                    Text = category.CategoryName.ToString()
                });
            }
            /*
            foreach (var category in categories)
            {
                var listItem = new SelectListItem();
                listItem.Value = category.CategoryId.ToString();
                listItem.Text = category.CategoryName.ToString();

                selectList.Add(listItem);
            }*/

            // returnam lista de categorii
            return selectList;
        }

        private void SetAccessRights()
        {
            ViewBag.isPartner = User.IsInRole("Partner");
            ViewBag.isAdmin = User.IsInRole("Admin");
            ViewBag.currentUser = User.Identity.GetUserId();
        }
    }
}